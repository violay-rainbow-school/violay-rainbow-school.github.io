---
layout: default
---

<div class="page-single">
    <div class="entry-header">       
        <h1 class="posttitle">{{ page.title }}</h1>        
    </div>
</div>

<!-- Flash messages -->
<div id="flash"></div>

<form action="#" id="calendar-form">
    <button class="btn btn-success" type="submit">Enregistrer</button>
    
    <!-- Select child -->
    <div class="calendar-child">
        <label for="child-select">Enfant :</label>
    
        <select name="child-select" id="child-select">
            <option value="sarah">sarah</option>
            <option value="jim">jim</option>
            <option value="jean">jean</option>
        </select>
    </div>
    
    <!-- Display monthly calendar -->
    {%- for month in page.months -%}
        <div class="calendar-month" month="{{ month }}"></div>
    {%- endfor -%}
    <button class="btn btn-success" type="submit">Enregistrer</button>
</form>

{% for date in page.closed_dates %}
    <div class="closed-date" style="display: none;">{{ date }}</div>
{% endfor %}

<script src="/assets/js/calendar/calendar.js"></script>
<script>
    const closedDates = [...document.querySelectorAll('.closed-date')].map(closedDateElement => new Date(closedDateElement.textContent));
    const calendarElements = document.querySelectorAll('.calendar-month');

    document.querySelector('#calendar-form').addEventListener('submit', function (event) {
        event.preventDefault();
        const selectedDates = [...document.querySelectorAll('.selected-date')].map(dateElement => dateElement.getAttribute('full-date'))
        console.log(selectedDates)
        // TODO: send data to an API to save the dates
    })
    
    calendarElements.forEach((calendarElement) => {
        let monthParts = calendarElement.getAttribute('month').split('-');
        let options = {
            calendarElement,
            closedDates,
            year: monthParts[0],
            month: monthParts[1] - 1,
        };
        
        createMonthCalendar(options);
    });
</script>